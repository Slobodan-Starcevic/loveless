---
import Layout from '../layouts/Layout.astro';
import Hero from '../components/landing/Hero.astro';
import WhatsOn from '../components/landing/WhatsOn.astro';
import GetReady from '../components/landing/GetReady.astro';
import Instagram from '../components/landing/Instagram.astro';

import { getCollection } from 'astro:content';

const allEvents = await getCollection('events');
---
<script>
   let clickCount = 0;
   document.addEventListener('DOMContentLoaded', () => {
     const splashScreen = document.querySelector('.splash-screen') as HTMLElement;
     const heart = document.querySelector('.heart') as HTMLElement;
     const messageElement = document.getElementById('message') as HTMLElement;
     const splashSeen: Boolean = localStorage.getItem('splash-seen') === 'true';

     if (heart && messageElement && !splashSeen) {
       splashScreen.style.display = 'flex';
       document.documentElement.style.overflow = 'hidden';
       document.body.style.overflow = 'hidden';

       heart.addEventListener('click', () => {
         clickCount++;

         switch (clickCount) {
           case 1:
              messageElement.textContent = "THAT'S NOT GOING TO FIX IT...";
              break;
           case 2:
             messageElement.textContent = "ALRIGHT...YOU'VE BEEN GHOSTED";
             setTimeout(() => {
               //localStorage.setItem('splash-seen', 'true');
               document.documentElement.style.overflow = '';
               document.body.style.overflow = '';
               splashScreen.style.display = 'none';
             }, 2000);
             break;
         }
       });
     }
   });
</script>
<Layout title="Mr Loveless Brisbane">
   <main id="main">
     <div class="splash-screen">
       <img src="/images/splash.jpg" class="background" alt="">
       <div class="heart-wrapper">
         <img src="images/loveless-pink.png" class="heart" alt="">
       </div>
       <div class="message-wrapper">
         <span id="message">...</span>
       </div>
     </div>
     <Hero events={allEvents} />
     <WhatsOn events={allEvents} />
     <GetReady events={allEvents} />
     <Instagram />
   </main>
</Layout>

<style lang="scss">
  .splash-screen {
    position: absolute;
    z-index: 10000;
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    width: 100%;
    overflow: hidden;
    background-color: #f5f5f5;

    .background{
      position: absolute;
      z-index: 0;
      width: 100%;
      height: 100%;
      object-fit: cover; /* Changed from 'fit' to 'cover' for better coverage */
      filter: brightness(20%);
    }

    .heart-wrapper {
      position: relative;
      z-index: 10;
      transition: transform 0.3s var(--custom-ease-1); /* Smooth scaling transition */
		overflow: visible;
      .heart {
        width: 300px;
        height: auto;
        cursor: pointer;
        animation: flicker 6s infinite, beat 5s infinite;
        transition: all 0.3s var(--custom-ease-1);
        filter: drop-shadow(0 0 50px var(--loveless-pink));
      }

      &:hover {
        transform: scale(1.1); /* Scale up on hover */
      }
    }

    .message-wrapper{
      z-index: 10;
      opacity: 0.9;
	  overflow: visible;
      span{
        color: var(--loveless-pink);
        font-family: 'Mortend';
        font-size: var(--font-size-xl);
        text-shadow: 0 0 10px var(--loveless-black), 0 0 20px #ff9beb;
		animation: flicker 6s infinite;
      }
    }
  }

  @keyframes flicker {
    0%, 19.999%, 22%, 62.999%, 64%, 64.999%, 70%, 100% {
      opacity: 0.99;
    }
    20%, 21.999%, 63%, 63.999%, 65%, 69.999% {
      opacity: 0.4;
    }
  }

  @keyframes beat {
    0%, 100% {
      transform: scale(1);
    }
    50% {
      transform: scale(1.1);
    }
  }
</style>
