---
import Layout from '../layouts/Layout.astro';
import ImageGallery from '../components/gallery/ImageGallery.vue';
import Return from '../components/Return.astro';
import {getCollection} from 'astro:content'
import {dateFormatterDDMY} from '../utils/dateFormatter' 

const allEvents = await getCollection('events');

const formattedDateEvents = allEvents.map(event => ({
    ...event,
    data: {
        ...event.data,
        date: dateFormatterDDMY(event.data.date)
    }
}))

const query = Astro.url.searchParams.get('id');
---
<script>
    document.addEventListener('mousemove', (e) => {
        const header = document.getElementById('floating-header') as HTMLElement;
        const rect = header.getBoundingClientRect();
        const titleCenterX = rect.left + rect.width / 2;
        const titleCenterY = rect.top + rect.height / 2;
        const deltaX = e.clientX - titleCenterX;
        const deltaY = e.clientY - titleCenterY;
        const moveX = Math.min(Math.max(deltaX * 0.05, -8), 8);
        const moveY = Math.min(Math.max(deltaY * 0.05, -6), 6);
        header.style.transform = `translate(${moveX}px, ${moveY}px)`;
    });
</script>

<Layout title="Gallery - Mr Loveless Brisbane">
	<main>
		<section class="gallery-wrapper bg-pink color-pink">
            <div class="gallery-cic-123">
                <Return color="pink"/>
                <div class="header-wrapper">
                    <h1 id="floating-header" class="stroke-pink">GALLERY</h1>
                    <h1>GALLERY</h1>
                </div>
                <ImageGallery eventsCollection={formattedDateEvents} client:load/>
            </div>
        </section>
	</main>
</Layout>

<style lang="scss">
    .header-wrapper{
        position: relative;
        overflow: visible;
        padding: var(--spacing-6xl) 0 var(--spacing-3xl) 0;
        display: flex;
        flex-direction: column;
        align-items: center;

        #floating-header{
            position: absolute;
            color: var(--loveless-black);
            transition: transform 0.2s ease-out;
        }
    }
    
    .gallery-wrapper {
        width: 100vw;
        min-height: 100vh;
        padding: var(--spacing-s);
        display: flex;
        
        .gallery-cic-123 {
            position: relative;
            width: 100%;
            padding: var(--spacing-l) 0;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            border-radius: var(--radius-2xl);
            background-color: var(--loveless-black);
            overflow: hidden;
        }
    }

    .gallery-2352 {
        width: 100%;
        height: 100%;
        display: flex;
        flex-wrap: wrap;
        gap: var(--spacing-xs);
        
        .gallery-item-2352 {
            position: relative;
            flex: 1 1 20%;
            min-width: 200px;
            min-height: 200px;
            overflow: hidden;

            .gallery-image-2352 {
                width: 100%;
                height: 100%; 
                object-fit: cover;
                position: absolute;
                top: 0;
                left: 0;
            }
        }
    }

    @media screen and (max-width : 767px) {
        .gallery-wrapper {
            padding: var(--spacing-2xs);
        }
        .header-wrapper{
            padding: var(--spacing-3xl) 0 var(--spacing-xl) 0;

            #floating-header{
                position: absolute;
                color: var(--loveless-black);
                transition: transform 0.2s ease-out;
            }
        }
    }
    @media screen and (min-width: 768px) and (max-width: 1079px) {
        .gallery-wrapper {
            padding: var(--spacing-xs);
        }
    }
    @media screen and (min-width : 1080px) {
        
    }
</style>
